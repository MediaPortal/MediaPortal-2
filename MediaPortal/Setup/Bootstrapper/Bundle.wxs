<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">

  <!-- This should NEVER be changed ! This is the product ID of MP2 main package. -->
  <?define UpgradeCode = "9743129C-FED3-404A-A66E-3C1557BE0178" ?>

  <Bundle Name="MediaPortal 2" Version="!(bind.packageVersion.MP2Client)" Manufacturer="Team MediaPortal" UpgradeCode="$(var.UpgradeCode)" Compressed="no">
    <BootstrapperApplicationRef Id="ManagedBootstrapperApplicationHost">
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\MP2BootstrapperApp.dll"/>
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\BootstrapperCore.config"/>
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\Prism.dll"/>
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\Prism.Wpf.dll"/>
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\System.Windows.Interactivity.dll"/>
      <Payload SourceFile="..\MP2BootstrapperApp\Bin\$(var.Configuration)\Microsoft.Deployment.WindowsInstaller.dll"/>

     
      </BootstrapperApplicationRef>
    
    <!-- Needed for the ManagedBootstrapperApplicationHost-->
    <WixVariable Id="WixMbaPrereqLicenseUrl" Value=""/>

    <Chain>

      <PackageGroupRef Id="NetFx451Web"/>
      <PackageGroupRef Id="redist"/>
      <PackageGroupRef Id="directx9"/>
      <PackageGroupRef Id="dokan"/>
      <PackageGroupRef Id="LAVFilters"/>

      <RollbackBoundary />

      <MsiPackage Id="MP2Client" SourceFile="..\MP2Client\Bin\$(var.Configuration)\en-us\MP2Client.msi" DisplayInternalUI="no" Compressed="yes" Vital="yes" Visible="yes"/>
      <MsiPackage Id="MP2Common" SourceFile="..\MP2Common\Bin\$(var.Configuration)\en-us\MP2Common.msi" DisplayInternalUI="no" Compressed="yes" Vital="yes" Visible="yes"/>
      <MsiPackage Id="MP2Server" SourceFile="..\MP2Server\Bin\$(var.Configuration)\en-us\MP2Server.msi" DisplayInternalUI="no" Compressed="yes" Vital="yes" Visible="yes"/>
    </Chain>
  </Bundle>
</Wix>
